---
title: 3 - Windows Exploitation
summary: Gaining Access step – a note for attacking Windows.
description: Gaining Access step – a note for attacking Windows.
---

# Resources

---

* [Pentesting Active Directory Mind Map - ODC](https://github.com/esidate/pentesting-active-directory/tree/main)
* [Top Five Ways I Got Domain Admin 2018 Edition - Adam Toscher](https://adam-toscher.medium.com/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa)

# Initial Access

---

### 1 - LLMNR Attack

## Principle

![exploit-llmnr-principle.png](../attachments/exploit-llmnr-principle.png)
Source: TCM

## Hands On


 > 
 > **<font color=red>responder -l</font> tun0 <font color=red>-dw</font>**</br>
 > Capture NTLM Hashes when DNS error occurs.

![tool-responder-llmnr_hash_capture.png](../attachments/tool-responder-llmnr_hash_capture.png)

**<font color=red>hashcat -m 5600 </font>myHashes.txt <font color=lightblue>/usr/share/wordlists/rockyou.txt</font>**</br>
Crack NetNTMLv2 hashes.

## Mitigation

* Disable LLMNR and NBT-NS
  * Local Computer Policy > Computer Configuration > Administrative Templates > Network > DNS Client > Multicast Name Resolution > OFF
  * Network Connections > Network Adapter Properties > TCP/IPv4 Properties > Advanced > WINS > NetBIOS over TCP/IP > Disable
* If this cannot be disabled
  * Network Access Control.
  * Enforce strong user password (over 14 characters) in order to make it harder to crack hashes.

---

### 2 - SBM Relay Attack
